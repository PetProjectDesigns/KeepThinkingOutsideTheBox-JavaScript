<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 18: Hoisting in JavaScript</title>

    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400&family=Roboto:wght@400&family=Inconsolata:wght@400&display=swap" rel="stylesheet">

    <style>
        /* --- CSS Variables for High Contrast (Light Mode Default) --- */
        :root {
            --color-bg-body: #FFFFFF;
            --color-text: #1A1A1A;
            --color-accent: #000000;
            --color-border: #DDDDDD;
            --color-code-bg: #F5F5F5;
            --color-highlight: #EEEEEE;
            --font-family-main: 'Merriweather','Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-family-code: 'Inconsolata','Consolas', 'Courier New', monospace;
        }

        /* --- Dark Mode Overrides --- */
        body.dark-mode {
            --color-bg-body: #121212;
            --color-text: #E0E0E0;
            --color-accent: #FAFAFA;
            --color-border: #333333;
            --color-code-bg: #222222;
            --color-highlight: #333333;
        }

        /* --- Base Styles --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family-main);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg-body);
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--color-bg-body);
            padding: 30px;
        }

        /* --- Header and Toggle --- */
        header {
            border-bottom: 2px solid var(--color-accent);
            padding-bottom: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 2.2rem;
            color: var(--color-accent);
        }

        .theme-toggle-btn {
            padding: 8px 15px;
            border: 1px solid var(--color-accent);
            background-color: transparent;
            color: var(--color-text);
            cursor: pointer;
            border-radius: 6px;
            font-weight: bold;
            transition: all 0.2s;
            margin-left: 20px;
        }

        .theme-toggle-btn:hover {
            background-color: var(--color-highlight);
        }

        body.dark-mode .theme-toggle-btn {
            border-color: var(--color-accent);
            color: var(--color-text);
        }

        /* --- Content and Typography --- */
        h2 {
            font-size: 1.8rem;
            color: var(--color-accent);
            margin-top: 30px;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--color-border);
            padding-bottom: 5px;
        }
        
        h3 {
             font-size: 1.4rem;
             color: var(--color-accent);
             margin-top: 25px;
             margin-bottom: 10px;
             border-left: 5px solid var(--color-accent);
             padding-left: 10px;
         }

        p {
            margin-bottom: 15px;
        }
        
        /* --- Interactive Section --- */
        .interactive-section {
            border: 2px dashed var(--color-accent);
            padding: 25px;
            margin: 30px 0;
            border-radius: 8px;
            text-align: center;
            background-color: var(--color-highlight);
        }

        .run-button {
            padding: 10px 20px;
            background-color: var(--color-accent);
            color: var(--color-bg-body);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: opacity 0.2s;
            margin-top: 10px;
        }
        
        .run-button:hover {
            opacity: 0.85;
        }

        #result-output {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--color-accent);
            background-color: var(--color-bg-body);
            font-size: 1rem;
            min-height: 40px;
            text-align: left;
            white-space: pre-wrap;
            font-family: var(--font-family-code);
        }

        /* --- Code Presentation --- */
        .code-block {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            padding: 15px;
            margin: 15px 0 25px 0;
            border-radius: 6px;
            overflow-x: auto;
        }

        pre {
            font-family: var(--font-family-code);
            font-size: 1rem;
            line-height: 1.5;
            color: var(--color-text);
            white-space: pre-wrap;
            text-align: left;
        }

        code {
            font-family: var(--font-family-code);
            background-color: var(--color-code-bg);
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .keyword {
            font-weight: bold;
            color: var(--color-accent);
        }
        .string {
            color: #C20000;
        }
        body.dark-mode .string {
            color: #90EE90;
        }
        .comment {
            opacity: 0.6;
            font-style: italic;
        }

        .explanation-box {
            padding: 15px;
            border-left: 5px solid var(--color-accent);
            background-color: var(--color-highlight);
            border-radius: 0 6px 6px 0;
            margin-top: 15px;
            font-style: italic;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding-top: 20px;
            margin-top: 40px;
            border-top: 1px solid var(--color-border);
            font-size: 0.9rem;
            color: var(--color-text);
        }
        
        /* Media Query for Mobile */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Hoisting in JavaScript</h1>
            <button id="theme-toggle" aria-label="Toggle Light/Dark Mode" class="theme-toggle-btn">
                <span class="icon">‚òÄÔ∏è</span> <span class="text">Dark Mode</span>
            </button>
        </header>

        <section id="introduction">
            <p><b>Hoisting</b> is JavaScript's default behavior of moving declarations (but not initializations) to the top of the current scope before code execution. This means you can use variables and functions before you formally declare them in your code. </p>
            <div class="explanation-box">
                <b>Concept:</b> Before the browser executes any JavaScript code, it takes a "first pass" through the code to find all function and variable declarations and reserves space for them.
            </div>
        </section>

        <section id="the-code">
            <h2>The Example Code: Variables vs. Functions</h2>
            <p>The code below demonstrates how Hoisting affects function declarations differently than variable declarations using <b>var</b>:</p>
            
            <div class="code-block">
                <pre>
<span class="comment">// Outputs: undefined</span>
<span class="keyword">console</span>.<span class="keyword">log</span>(hoistedVar); <span class="comment">// Variable declaration is hoisted, but the value is not.</span>
<span class="keyword">var</span> hoistedVar = <span class="string">'Hoisted'</span>;

<span class="comment">// Outputs: Hello, Hoisting!</span>
hoistedFunction(); <span class="comment">// The entire function is hoisted, so it runs successfully.</span>
<span class="keyword">function</span> hoistedFunction() {
    
    <span class="keyword">console</span>.<span class="keyword">log</span>(<span class="string">'Hello, Hoisting!'</span>);
}</pre>
            </div>
        </section>

        <section id="function-hoisting">
            <h3>1. Function Hoisting (Full Hoist)</h3>
            <ul>
                <li><b>Behavior:</b> The entire function definition is moved to the top of the scope.</li>
                <li><b>Result:</b> This allows you to call the function (<b>hoistedFunction()</b>) anywhere in the code, even before its definition line.</li>
            </ul>
        </section>

        <section id="variable-hoisting">
            <h3>2. Variable Hoisting with `var` (Declaration Only)</h3>
            <ul>
                <li><b>Behavior:</b> Only the declaration (<b>var hoistedVar;</b>) is moved to the top. The assignment/initialization (<b>= 'Hoisted'</b>) stays in place.</li>
                <li><b>Result:</b> When you access <b>hoistedVar</b> before its assignment, it exists but has a default value of <b>undefined</b>.</li>
                <li><b>Note:</b> Variables declared with <b>let</b> and <b>const</b> are also hoisted, but they cannot be accessed before their declaration line. Trying to do so results in a <b>ReferenceError</b> (this is called the "Temporal Dead Zone"). For this reason, <b>let</b> and <b>const</b> are generally preferred over <b>var</b>.</li>
            </ul>
        </section>

        <section id="demonstration">
            <h2>Live Output Demonstration</h2>
            <p>Click the button to see the results. Note that the variable logging first returns <b>undefined</b>, while the function call works perfectly.</p>

            <div class="interactive-section">
                <button onclick="runHoistingDemo()" class="run-button">
                    Run Hoisting Example
                </button>
                
                <div id="result-output">
                    </div>
            </div>
        </section>
        
        <footer>
          <p>Keep Thinking Outside The Box: A Beginners Guide To JavaScript For ADHD Brains</p>
        </footer>
    </div>
    
    <script>
        let output = "";

        // Function definition (Hoisted)
        function hoistedFunction() {
            output += `Hoisted Function Output: Hello, Hoisting!\n`;
        }

        // Function called by the button (Demonstration)
        function runHoistingDemo() {
            output = "";
            const resultOutput = document.getElementById('result-output');
            
            // 1. Variable access before declaration (hoistedVar = undefined)
            output += `console.log(hoistedVar) outputs: ${hoistedVar}\n`;
            var hoistedVar = 'Hoisted'; // Declaration hoisted, assignment runs here

            // 2. Function call before declaration (hoistedFunction runs successfully)
            hoistedFunction();

            resultOutput.innerText = output;
        }

        // Theme Toggle Logic 
        document.addEventListener('DOMContentLoaded', () => {
            const toggleButton = document.getElementById('theme-toggle');
            const body = document.body;
            const currentTheme = localStorage.getItem('theme');

            function updateToggleText(theme) {
                const isDark = theme === 'dark-mode';
                toggleButton.querySelector('.icon').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
                toggleButton.querySelector('.text').textContent = isDark ? 'Light Mode' : 'Dark Mode';
            }

            if (currentTheme) {
                body.classList.add(currentTheme);
                updateToggleText(currentTheme);
            } else {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    body.classList.add('dark-mode');
                    updateToggleText('dark-mode');
                } else {
                    updateToggleText('light-mode');
                }
            }

            toggleButton.addEventListener('click', () => {
                const isCurrentlyDark = body.classList.contains('dark-mode');
                
                if (isCurrentlyDark) {
                    body.classList.remove('dark-mode');
                    body.classList.add('light-mode');
                    localStorage.setItem('theme', 'light-mode');
                    updateToggleText('light-mode');
                } else {
                    body.classList.remove('light-mode');
                    body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark-mode');
                    updateToggleText('dark-mode');
                }
            });
            
            // Set initial state
            document.getElementById('result-output').innerText = 'Click the button to see the effects of Hoisting.';
        });
    </script>
</body>
</html>